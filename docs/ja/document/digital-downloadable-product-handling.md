---
title: デジタル/ダウンロード可能な製品ガイド
url: https://woocommerce.com/document/digital-downloadable-product-handling/
---

デフォルトのダウンロード商品設定はほとんどのWoo加盟店でご利用いただけますが、一部の加盟店では異なる設定が必要となる場合があります。このページでは、様々なダウンロード商品設定についてご案内し、お客様のニーズに合った設定を見つけるお手伝いをいたします。

このページでは以下の内容を学びます:

- ファイルのダウンロード方法の選択と設定方法。
- アップロードファイルを不正アクセスから保護する方法。
- ダウンロード可能な製品の保存場所の選択方法。
- 顧客がダウンロード可能な製品を受け取り、アクセスする方法。

1. **WooCommerce > 設定 > 商品 > ダウンロード可能な商品** に移動します。
2. ドロップダウンからファイルのダウンロード方法を選択します。
- **強制ダウンロード** – [PHP](https://woo.com/document/digital-downloadable-product-handling/#force-downloads-require-allow_url_fopen-to-be-on) を使用して、ファイルのダウンロードを強制します。ファイルへの直接リンクを防ぐために、強制ダウンロードを使用できます。ただし、ファイルのサイズが大きい場合やサーバーの処理能力が不足している場合は、ダウンロード中にタイムアウトが発生する可能性があります。その場合は、サーバーをアップグレードするか、リダイレクト方法のいずれかを使用する必要があります。**注:** 強制ダウンロードにはPHPの機能が必要です。PHPのallow_url_fopen関数をOnに設定する必要があります。サイトの allow_url_fopen のステータスを確認するには、以下のいずれかの方法で phpinfo() ページを作成するか (こちらを参照) (https://woocommerce.com/document/finding-php-error-logs/#php-error-logs-on-the-server)、[WordPress.org の phpinfo プラグイン](https://wordpress.org/plugins/search/phpinfo/) のいずれかをインストールするか、ホスティングサービスのサポートにお問い合わせください。
- **X-Accel-Redirect/X-Sendfile** – ダウンロードはサーバー (nginx/apache) によって処理されます。この方法では、X-Accel-Redirect/X-Sendfile モジュールがサーバーにインストールされ、有効化されている必要があります。この方法を使用する前に、これらのモジュールのいずれかがインストールされていることをホスティングサービスにご確認ください。**これは最も信頼性の高い方法** です。ファイルが顧客に直接提供されるためです。このオプションは、最高のパフォーマンスとセキュリティを提供します (ファイルは .htaccess ファイルによって保護されます)。
- **リダイレクトのみ（安全でない）** – 顧客は提供されたリンクを介してファイルに直接リダイレクトされ、ダウンロードにアクセスします。この方法を使用すると、アップロードリンクを知っている人は誰でも、ログインしていなくてもファイルにアクセスできます。製品を購入した顧客が、ログインしていない他のユーザーとリンクを共有できるというリスクがあります。
  

**注**: 「強制ダウンロード」または「X-Accel-Redirect/X-Sendfile」のいずれかを選択した場合、「最終手段としてリダイレクトモード（非セキュア）の使用を許可する」設定を有効にすることができます。この設定を有効にすると、選択した方法（強制ダウンロードまたはX-Accel-Redirect）を使用してファイルを顧客に配信/提供できない場合に、「リダイレクト方式」が使用されるようになります。これは上記の「リダイレクトのみ」方式と同じリスクを伴いますが、複数のプラットフォームにまたがってアセットをホストしており、優先方式が機能しない可能性がある場合に役立ちます。

1. 「アクセス制限」オプションを選択します。
- ファイルをダウンロードする際にログインが必要な場合は、「**ダウンロードにはログインが必要**」チェックボックスにチェックを入れます。ゲストチェックアウトは無効にする必要があります。
- 注文が「完了」ではなく「処理中」の時にファイルへのアクセスを許可する場合は、「**支払い後にダウンロード可能な製品へのアクセスを許可する**」チェックボックスにチェックを入れます。これは、ダウンロード可能な製品と物理製品を一緒に販売している場合に特に便利です。お客様は物理製品の到着を待たずにダウンロード可能なコンテンツにアクセスできます。
  
2. 「**セキュリティのためにファイル名に一意の文字列を追加する**」を有効のままにするかどうかを決定します。この設定は、ファイルのセキュリティを強化するためにデフォルトで有効になっています（推奨）。アップロードディレクトリが適切に構成され、他の手段で保護されている場合は、有効にする必要はありません。この設定を有効または無効にしても、以前にアップロードされたリンクやファイルには影響しません。変更後にアップロードされたファイルにのみ影響します。
3. 「**変更を保存**」をクリックします。

**注:** 追加の設定は、**WooCommerce > 設定 > 商品 > 承認済みダウンロードディレクトリ**（ページ上部のメニューの「ダウンロード可能な商品」の横）で確認できます。これらの設定は、ショップマネージャーまたは商品編集権限を持つユーザーが1人以上いるサイトで特に便利です。詳しくは[こちらをクリック](https://woocommerce.com/document/approved-download-directories/)をご覧ください。

デフォルトでは、WooCommerce は `wp-content/uploads/woocommerce_uploads` ディレクトリを保護するために `.htaccess` ファイルを導入しますが、すべてがサーバーの構成に依存するため、このディレクトリの保護は保証されません。

サイトでNGINXサーバーを使用し、**X-Accel-Redirect/X-Sendfile**または**Force Downloads**ダウンロード方式を使用している場合は、セキュリティ強化のために設定を変更する必要があります。詳細については、[WooCommerce開発者ドキュメント](https://developer.woocommerce.com/docs/code-snippets/using_nginx_server_to_protect_your_uploads_directory/)をご覧ください。

「設定と構成」で説明されているように、WooCommerce はセキュリティを強化するためにアップロードされたファイルのファイル名に一意の文字列を追加します。この設定は、WooCommerce のインストールごとにデフォルトで有効になっています。

ダウンロード可能な商品のファイルの保存方法は、お客様の好みと、デジタル商品に必要なセキュリティレベルによって異なります。WooCommerce は有効な外部 URL のみで動作するため、アップロードしたファイルの保存方法はいくつかあります。

このセクションでは、ストレージとアップロード ディレクトリの管理および保護の方法に関するいくつかの質問に答えます。

#### クラウド ストレージを使用してファイルやダウンロードを保存できますか?

簡単に答えると、「はい」です。

WooCommerce が機能するには、デジタルダウンロードファイルを指す外部 URL のみが必要です。追加の検証は必要ありません。ただし、Google Drive などの一部のクラウドストレージプロバイダーは、ファイルダウンロード方法として「リダイレクトのみ（安全でない）」を選択した場合にのみ機能します。[セットアップと構成](https://woo.com/document/digital-downloadable-product-handling/#setup-and-configuration) セクションで、これらの方法の違いについて説明しています。

#### メディアライブラリから製品にファイルを添付しました。ファイルを保護してアクセスできないようにするにはどうすればよいですか？

WooCommerce を使わずにメディアライブラリからファイルをアップロードすると、リンクを知っている人なら誰でもファイルにアクセスできます。WordPress のメディアライブラリは、投稿やページに添付されたすべての画像を保存するため、本質的に公開されています。ダウンロード可能な製品がこのような方法でアクセスされるのを防ぐには、メディアライブラリからファイルを選択するのではなく、WooCommerce からファイルをアップロードしてください。これは、「製品編集」ページからファイルをアップロードすることで実現できます。WooCommerce はこれらのファイルを `woocommerce_uploads` フォルダにアップロードしますが、このフォルダは一般ユーザーからはアクセスできません。

#### どのようなファイル拡張子を使用できますか?

WooCommerce では、WordPress で定義されているものと同じファイル拡張子を使用できます。完全なリストは [WordPress Codex: ファイルのアップロード](https://codex.wordpress.org/Uploading_Files) でご覧いただけます。

#### 使用できるファイルの最大サイズはどれくらいですか?

WooCommerce自体には最大ファイルサイズ制限はありません。ただし、ウェブサイトのサーバーには上限がある可能性があります。上限の引き上げが必要な場合は、ホスティング会社にお問い合わせください。

お客様がダウンロード製品を注文すると、購入した製品のダウンロードリンクが記載されたメールが届きます。お客様が貴社のサイトにアカウントをお持ちの場合は、「マイアカウント」>「ダウンロード」からダウンロードリンクにアクセスすることもできます。ダウンロード製品の設定が、お客様のダウンロードへのアクセスにどのような影響を与えるかについて、いくつか注意すべき点があります。

- 「お支払い後にダウンロード可能な商品へのアクセスを許可する」を有効にすると、お客様は注文受付ページのリンク、注文メール、またはストアアカウントをお持ちの場合は「マイアカウント > ダウンロード」ページから商品をダウンロードできます。
- 「お支払い後にダウンロード可能な商品へのアクセスを許可する」を有効にしない場合、お客様は注文が「完了」になった場合にのみダウンロードにアクセスできるようになります。「仮想」と「ダウンロード可能」の両方にマークされている商品の場合、このプロセスは自動的に行われます。商品が「ダウンロード可能」のみにマークされている場合は、お客様がダウンロードにアクセスできるように、手動で注文を完了する必要があります。

**PayPal Standard（非推奨）に関する注意:**

PayPalスタンダード（非推奨）をご利用の場合、IPNを使用して支払いを追跡する際に遅延が発生し、「注文受領」ページにファイルリンクが表示されない場合があります。この問題を回避するには、以下の手順に従うか、推奨のPayPalプラグインである[PayPal Payments](https://woocommerce.com/products/woocommerce-paypal-payments/)に切り替えてください。PayPalスタンダードを引き続きご利用になる場合は、以下の手順に従ってください。

1. ゲートウェイ設定でPayPal IDトークンとして[Payment Data Transfer](https://developer.paypal.com/api/nvp-soap/payment-data-transfer/) (PDT) を選択し、有効化します。
2. PayPalアカウントの**「プロフィール」>「プロフィールと設定」>「販売ツール」>「ウェブサイト設定」でPDTを有効化します。
3. 自動返信を有効化し、返信URLをhttps://shipyouridea.com/checkout/order-received/（shipyouridea.comをご自身のウェブサイトのアドレスに置き換えてください）と入力し、PDTを有効化します。
4. WooCommerce > 「設定」>「チェックアウト」>「Paypal」の設定にIDトークンをコピーします。これにより、PayPal IPNを必要とせずに支払いが認証されるようになります。

注文の処理と支払いが完了すると、顧客はダウンロード用のクリック可能なリンクを含む請求書/注文確認書を受け取ります。

ご注文完了メールにダウンロードファイルへのリンクが含まれていない場合は、サイトのデータベースに問題がある可能性があります。修正方法については、こちらをご参照ください: [https://woocommerce.com/document/completed-order-email-doesnt-contain-download-links/](https://woocommerce.com/document/completed-order-email-doesnt-contain-download-links/)

以下の手順に従って、購入したダウンロード可能なアイテムへの顧客のアクセスを編集できます。

1. **WooCommerce > 注文** に移動し、表示または編集する注文を選択します。
2. **ダウンロード可能な製品の権限** メタボックスまでスクロールダウンします。ダウンロード内容と、顧客がアクセスした回数が表示されます。
3. アクセスを取り消すか、新しいダウンロードへのアクセスを許可するか、注文を終了します。

**顧客がダウンロード製品を購入した後にその製品のファイルを編集するとどうなりますか?**

- 既存のダウンロードファイル行を*編集*（名前、ファイルURL、またはその両方を変更）すると、過去の購入のダウンロードリンクは更新されますが、有効期限とダウンロードはそのまま残ります。
- 新しいダウンロードを*追加*しても、過去の注文には影響しません。新規購入者のみがダウンロード権限を取得できます。

製品に追加されたすべてのダウンロードに対して「生涯アクセス」などといった権限を付与する製品がある場合は、サブスクリプションまたはメンバーシップの方が適している可能性があります。ファイルを1つのアーカイブ（zip）にまとめることもできます。以前の機能を復元したい場合は、[こちらからプラグインをご利用いただけます](https://github.com/woocommerce/grant-download-permissions-for-past-woocommerce-orders)

レポートでは、デジタル商品/ダウンロード可能な商品のダウンロードに関する固有IDを追跡し、記録します。詳細については、[WooCommerce レポート](https://woocommerce.com/document/woocommerce-analytics/#downloads-report) をご覧ください。

まだ質問があり、サポートが必要ですか?

このドキュメントは、無料の[コア WooCommerce プラグイン](https://wordpress.org/plugins/woocommerce/)に関するものです。このプラグインのサポートは、[WordPress.org のコミュニティフォーラム](https://wordpress.org/support/plugin/woocommerce) で提供されています。このフォーラムを検索すると、同じ質問が過去に投稿され、回答されているケースがよくあります。フォーラムを利用するための WordPress.org アカウントをまだ作成していない場合は、[作成方法はこちら](https://make.wordpress.org/contribute/join/)をご覧ください。

- ここで紹介したコア機能を**拡張**したい場合は、[WooCommerce マーケットプレイス](https://woocommerce.com/products/)で利用可能な拡張機能をご確認ください。
- 継続的な高度なサポートや WooCommerce 向けの**カスタマイズ**が必要ですか？[Woo エージェンシー パートナー](https://woocommerce.com/customizations/)をご活用ください。
- 独自の WooCommerce 統合機能や拡張機能を開発している**開発者**ですか？[開発者向けリソース](https://developer.woocommerce.com/)をご確認ください。

必要な情報が見つからない場合は、下のフィードバック サムを使用してお知らせください。

